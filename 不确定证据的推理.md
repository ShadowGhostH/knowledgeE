# 实验报告

姓名：许征航		学号：2021532113

## 实验目标

题目：主观贝叶斯模型的不确定性推理算法

## 算法实现

本次算法利用 VS code 进行代码编写，扩充了第一次作业的内容，添加了 uncertainCon 和 uncertainSearch 两个C++ 文件和对应头文件，利用 cmake 进行编译。其中

- util.cpp 实现了我习惯使用的一些函数、debug方式、错误信息抛出、文件处理等工具，是我在多个项目中都会使用的基本函数实现。
- uncertainCon.cpp 实现了本项目中的推理规则处理，记录了产生式语句，以及对应的证据事实和结论信息，LS LN 信息也在这里进行维护。同时这这里实现了不确定证据的相关功能实现
- uncertainSearch.cpp 实现了对语句的判断和后验概率以及后验几率的计算，是进行推理的部分
- main.cpp 对 uncertainSearch.cpp 中的类进行调用，读取文件并求解

项目的目录结构如下

<img src="/Users/eliot/Library/Application Support/typora-user-images/image-20220429163650875.png" alt="image-20220429163650875" style="zoom:50%;" />

上面展示的 Rule3 文件为本次的输入文件，定义了事实以及事实之间的推理规则，项目可以读取不同的 Rule 文件，来对不同的实例进行推理。本次推理网络基于讲义中给出的内容

## 运行与实验

在使用cmake进行编译之后，可以在当前文件夹中得到 可执行文件 Solver，项目提供了 INSTALL.sh 作为编译脚本。Solver 接受一个输入，为对应规则的文件路径。调用方式为 `./Solver ruleFile` ，由此可以实现对不同产生式规则集合的推理。

首先在不修改规则文件的情况下，进行第一次实验。所用输入和讲义上的例题保持一致

<img src="/Users/eliot/Library/Application Support/typora-user-images/image-20220429195345631.png" alt="image-20220429195345631"/>

解答器在读取规则 Rule3 后，向用户做出询问，由用户给出可信任度信息。然后根据可信任信息进行计算。

解答器把计算分段函数时，所用到的，选取分段函数中哪一段的信息（也就是选择的理由）列举了出来，并标识了 "由于 XXX => "

从中我们可以看到，在可信度为正数的情况下($C(FMGS | E_1') = 3, C(PT | E_2') = 1$)，说明证据对他们有支持作用，会得到 $P(FMGS|E_1') > P(FMGS)$，更进一步的，在 $LS$ 的作用下，会使得 $P(STIR|E_1') = 0,14901 > P(STIR) = 0.1$ 

在可信度为负数的情况下 ($C[SMIR|E_3'] = -2$) ，计算得到的 $P(HYPE|E_3') = 0.006 < P(HYPE) = 0.01$。



第二次实验，我们选择相应的增大或减小可信度，来看可信度变化对后验概率的影响。

![image-20220429200727946](/Users/eliot/Library/Application Support/typora-user-images/image-20220429200727946.png)

和实验一进行对比我们可以发现，当可信度 $C[E|E']>0$ 是，$P(E|E') > P(E)$ ，此时减小 $C[FMGS|E_1']: 2\to1$ ，会使得 $P(STIR|E_1')$  也跟着变小。而增大  $C[PT|E_2']:1\to2$ ，会使得 $P(STIR | E_2')$ 也跟着变大。

当可信度 $C[E|E'] < 0$ 时，$P(E|E') < P(E)$ ，此时减小 $C[SMIR|E_3']: -2\to -3$ ，会使得 $P(HYPE|E_3')$  也跟着变小。

这说明可信度的大小变化，和对应概率的变化是保持一致的。当两个证据的可信度一个增强一个降低时，他们共同作用下的 $P(STIR | E_1' \,\&\, E_2')$ 的变化需要结合 $LS$ 的值具体分析。从此例中我们可以发现，$P(HYPE|E_1' \& E_2' \& E_3')$ 仍是变大了



由于前两次实验，$E_1', E_2'$ 对于 $STIR$ 都起到了支持作用，所以计算的分支中，在公式 （6-14）都使用了 $P(E|E') > P(E)$ 的分支，这次实验希望可以调用 $P(E|E') \le P(E)$ 的分支，而为了调用这个分支，就需要对其有削弱作用。同时在此次试验中，对比 $C[E|E'] = 0$ 的情况

![image-20220429202834127](/Users/eliot/Library/Application Support/typora-user-images/image-20220429202834127.png)

此次试验中可以看出，在计算 $O(HYPE | E_1' \& E_2')$ 的时候，进入了我们预想的另外一条分支。而在计算 $P(STIR|E_1')$ 和 $P(STIR|E_2')$ 的时候，意外的得到了两个相同的值。在对实例进行分析后，我们发现，是因为它们具有相同的可信度，以及在可信度都是负数的情况下，他们的 $LN$ 值相等，于是对后验概率产生了相同的削弱作用，使得 $P(STIR|E_1') = P(STIR|E_2') = 0.08 < P(STIR) = 0.1$ 

而当 $C(E|E') = 0$  时，应当得到 $P(E|E') = P(E)$ ，在此例中也得到了验证

## 实验总结

- 通过实现贝叶斯网络的不确定推理模型，对推理过程有了更加深刻的认识
- 设计了在相同规则下，不同输入的推理。体会了可信度在推理过程中的具体作用，了解了分段函数不同段的具体实现和意义
- 通过控制变量和逻辑意义的相互验证，了解了处理不确定信息时，概率论的强力支持
