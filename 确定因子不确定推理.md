# 实验报告

姓名：许征航		学号：2021532113

## 实验目标

题目：确定性因子模型的不确定性推理算法

## 算法实现

本次算法利用 VS code 进行代码编写，扩充了第一次作业的内容，添加了 uncertainCon 和 uncertainSearch 两个C++ 文件和对应头文件，利用 cmake 进行编译。其中

- util.cpp 实现了我习惯使用的一些函数、debug方式、错误信息抛出、文件处理等工具，是我在多个项目中都会使用的基本函数实现。
- uncertainCon.cpp 实现了本项目中的推理规则处理，记录了产生式语句，以及对应的证据事实和结论信息，LS LN 信息也在这里进行维护
- uncertainSearch.cpp 实现了对语句的判断和后验概率以及后验几率的计算，是进行推理的部分
- main.cpp 对 uncertainSearch.cpp 中的类进行调用，读取文件并求解

项目的目录结构如下

<img src="/Users/eliot/Library/Application Support/typora-user-images/image-20220409233414934.png" alt="image-20220409233414934" style="zoom:50%;" />

上面展示的 Rule2 文件为本次的输入文件，定义了事实以及事实之间的推理规则，项目可以读取不同的 Rule 文件，来对不同的实例进行推理。

## 运行与实验

在使用cmake进行编译之后，可以在当前文件夹中得到 可执行文件 Solver，项目提供了 INSTALL.sh 作为编译脚本。Solver 接受一个输入，为对应规则的文件路径。调用方式为 `./Solver ruleFile` ，由此可以实现对不同产生式规则集合的推理。

首先在不修改规则文件的前提下，进行第一次实验

![image-20220409233701014](/Users/eliot/Library/Application Support/typora-user-images/image-20220409233701014.png)

Solver 会读取 ruleFile 当中的相关规则，然后筛选出事实集合，请用户按照相关事实，输入相关事实是否是真实的。同时输入结论的先验概率，在得到先验概率后，会根据证据是否真实，调用 LS 或 LN 信息进行求解。

从第一次实验可以看出，E1 E2 E3 E4 E5 对于 H1 都有一定的支持作用。其中 E2 的支持最高，在 E2 为真的时候，H1 为真的概率提升了30 倍。这个结果和 E3 的 lS 值最大是相符合的。

而第一次实验中，虽然 E1-E4 为真都对 H1 有支持作用，但是其中某个为真的 E5‘ 对 H1 却几乎没有支持。为了体现 LN 的作用，第二次实验将所有事实都定义为假，H1 的先验概率保持不变。

![image-20220410000429185](/Users/eliot/Library/Application Support/typora-user-images/image-20220410000429185.png)

虽然由于 E1-E4 的 LN=1，所以在它们为假时，我们看到后验概率 $P(H_1|\lnot E_1) = P(H_1)$ 

但是当 E5 为假的时候，后验概率  $P(H_1|\lnot E_5) = 0.00000618557$ 削弱了约 4849 倍。  

第三次实验尝试改变先验概率的取值，在先验概率变化的情况下，看后验概率会发生什么编码。将 $P(H) = 0.3$ 扩大了十倍，由于E1-E4 的 LN 值都为1，对后验概率没有影响，所以这次仍然设置为 E1-E4 全为真

![image-20220410001556684](/Users/eliot/Library/Application Support/typora-user-images/image-20220410001556684.png)

可以发现，在支持能力的大小上，仍然和LS保持相同的顺序，这个也和我们认为的LS大小表示支持能力大小是一致的。同时可以看出，因为事件的概率会影响事件的几率，所以进而对后验几率的影响也较为显著。而因为事件本身的概率增大，在得到它的某个支撑后，事件的后验概率最多超过了 $0.99$ 。

## 实验总结

- 通过实现确定因子模型的不确定推理，对推理过程有了更加深刻的认识
- 设计了在相同规则下，不同输入的推理。体会了 LS lN 的对事件概率的 **支持** 和 **削弱** 作用
- 通过几率和概率的相互转化关系，对不确定推理的提出原因和存在意义又了更深刻的认识
